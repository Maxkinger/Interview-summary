## 计算机网络复习



### 一、基本概念

* 单工通信

  只有一个方向的通信而没有反方向的交互，仅需要一条信道（发送信道或接收信道）。

* 半双工通信

  通信的双方都可以接收或发送信息，但是任何一方不能同时接收和发送，需要两条信道

* 全双工通信

  通信双方可以同时接收和发送信息，需要两条信道。
  
* 端对端通信 & 点对点通信

  数据传输的可靠性是通过数据链路层和网络层的点对点和传输层的端对端保证的。

  点对点是基于 MAC 地址或者 IP 地址，是指一个设备发数据给另外一个设备，这些设备是指直连设备包括网卡，路由器，交换机。端对端是应用程序之间的远程通信。端对端不需要知道底层是如何传输的，是一条逻辑链路。

  在一个网络系统的不同分层中，可能用到端到端传输，也可能用到点到点传输。如 Internet 网，IP 及以下各层采用点到点传输，IP 层以上采用端到端传输。

  端对端，主要服务于Application Layer,是说两台主机（终端），跨过网络连接。
  点对点，是说两台主机（终端）在局域网中传输。

### 二、数据链路层

#### 功能

* 为网络层提供服务

  提供的服务包括，无连接无确认服务，无连接有确认服务，有连接有确认服务。

* 链路管理，建立、维持、释放连接。

* 组帧

* 流量控制

* 差错控制 （帧错/位错）

#### 链路层流量控制

* 停止-等待协议
  * 每发送一个帧就停止发送，等待对方的确认，收到确认后在发下一个帧
  * 相当于 发送窗口大小 =  接受窗口大小 = 1 的滑动窗口
* 滑动窗口协议
  * 后退 N 帧协议 GBN
    * 发送窗口大小 > 1，接受窗口大小 = 1
  * 选择重传协议 SR
    * 发送窗口大小 > 1，接受窗口大小 > 1

#### 信道划分介质访问控制

* 静态信道划分
  * 时分复用
  * 频分复用
* 动态信道划分
  * 令牌
  * ALOHA
  * CSMA/CD
  * CSMA/CA

#### 广域网

* 单向信道
* 覆盖网络层、数据链路层和物理层
* ppp 协议（point to point protocol），面向字节协议，全双工
* HDLC 协议，面向比特协议，全双工

#### 局域网

* 广播信道
* 只覆盖物理层和数据链路层
* 某一区域内的计算机组成的网络
* 介质访问
  * CSMA/CD 常用于总线型局域网
  * 令牌总线 & 令牌环
* 局域网分类
  * 以太网 （CSMA/CD）IEEE802.3
  * FDDI
  * ATM
  * 令牌环网（单点故障）
  * 无限局域网 WLAN IEEE802.11

#### 以太网

* 提供无连接、不可靠的服务。只实现无差错接收，差错帧直接丢弃，不向发送方确认。

### 三、网络层

#### 功能

* 路由选择与分组转发
* 异构网络互联
* 拥塞控制

#### 数据交换方式

* 电路交换（电话网络）

* 报文交换

* 分组交换，把数据分割成很多小数据包，以并发的形式在路线上传播，最快的方式，互联网就是用这种方式交换数据

  <img src="计算机网络.assets/image-20201007214551085.png" alt="image-20201007214551085" style="zoom:50%;" />

* 报文交换与分组交换需要进行存储转发

#### 数据报方式&虚电路方式

* 分组交换方式包括 **数据包交换方式 & 虚电路交换方式 **

* 数据报方式为网络层提供无连接服务

  无连接服务不事先为分组确定传输路路径，每个分组独立确定传输路径，不同分组传输路径可能不同。

* 虚电路方式为网络层提供连接服务

  首先为分组确定传输路径，即建立连接，然后沿该路径传输系列分组，系列分组传输路径相同，传输结束后拆除连接。

  <img src="计算机网络.assets/image-20201007215938884.png" alt="image-20201007215938884" style="zoom:67%;" />

#### 传输单元名词辨析

<img src="计算机网络.assets/image-20201007215806439.png" alt="image-20201007215806439" style="zoom:50%;" />

#### IP 数据报分片

IP 数据报分片的原因是因为链路层传输受到 MTU （最大传输单元）限制，所以过大的 IP 数据包必须分片传输。

#### IP 地址

IP 地址标识的是路由器和主机的接口，不是标识主机。一台主机可能无线接口和有限接口。路由器可以有多个接口，每个接口有一个 IP 地址，不同的接口可以连不同的网络。

私有 IP 地址如下：

<img src="计算机网络.assets/image-20201007222522007.png" alt="image-20201007222522007" style="zoom:50%;" />

在局域网和英特网之间使用网络地址转换 NAT（Network Address Translation），就可以将私有 IP 转化为外网 IP，然后就可以和英特网通信了。安装了 NAT 软件的路由器成为 NAT 路由器。

#### 子网划分

<img src="计算机网络.assets/image-20201007223034963.png" alt="image-20201007223034963" style="zoom:50%;" />

子网划分用来解决网络 IP 分类的缺点：

* 网络利用率不高。子网划分可以把一个大网划分成很多小网，而不用让很多小网络取申请远超其容量的 A 类或者 B 类网络。
* 很难轻易网络扩大 IP 容量。

IP 地址和子网掩码做按位与运算就可以得出子网网络地址。

#### CIDR 无分类编址

<img src="计算机网络.assets/image-20201007224555287.png" alt="image-20201007224555287" style="zoom:50%;" />

#### ARP 协议

每一台主机上都有 ARP 高速缓存，里面保存了局域网内 IP 地址与 MAC 地址的映射。为什么要有 MAC 地址？因为网络层 IP 数据包向下传输到链路层时，需要在尾部加上 MAC 地址成为帧。

如果缓存内没有对应的 MAC 地址，就会在局域网内广播以获取相应 IP 地址与 MAC 地址的映射。

如果还是没找到，就会把 MAC 地址换成网关的，然后由网关传输到外网。

#### DHCP 协议

动态分配 IP 地址给入网主机。

<img src="计算机网络.assets/image-20201007225940397.png" alt="image-20201007225940397" style="zoom:50%;" />

#### ICMP 协议

当数据报发送出了差错后，就要使用 ICMP 协议来通知源点。

<img src="计算机网络.assets/image-20201007230558264.png" alt="image-20201007230558264" style="zoom:50%;" />

#### 路由算法

* 内部网关协议
  * RIP 协议 & 距离向量算法
  * OSPF 协议 & 链路状态算法
* 外部网关协议
  * BGP 协议

### IP 数据报的三种传输方式

<img src="计算机网络.assets/image-20201007231146311.png" alt="image-20201007231146311" style="zoom:50%;" />

### TCP/IP 协议栈

<img src="计算机网络.assets/image-20201007220754016.png" alt="image-20201007220754016" style="zoom: 50%;" />

看这篇就够了 [一文搞定 UDP 和 TCP 高频面试题！ - 知乎](https://zhuanlan.zhihu.com/p/108822858)

